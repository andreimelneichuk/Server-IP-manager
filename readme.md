t# Сервер IP Manager

Этот проект предоставляет сервер управления IP с поддержкой подключений Telnet, HTTP, WebSocket и UnixSocket. Сервер позволяет пользователям извлекать и устанавливать IP-адреса в определенном сетевом интерфейсе.

## Требования

- C++17 или более поздней версии
- Библиотеки Boost (`asio`, `beast`)
- - Библиотека Lohmann JSON
- GCC/Clang (для компиляции)
- - Make (для автоматизации сборки)st

## Инструкции по сборке и запуску

### 1. Клонирование репозитория

```bash
git clone https://github.com/your-repo/ip-manager-server.git
cd ip-manager-server
```

### 2. Установите зависимости

Убедитесь, что в вашей системе установлены Boost и библиотека Nlohmann JSON.

#### В Ubuntu:

```bash
sudo apt-get update
sudo apt-get install libboost-all-dev
sudo apt-get install nlohmann-json3-dev
```

#### На macOS (с Homebrew):

```bash
brew install boost
brew install nlohmann-json
```
### 3. Компиляция сервера

Для сборки сервера можно использовать компилятор "g++" или "clang++". Ниже приведен пример команды для компиляции с использованием `g++`:

```bash
g++ -std=c++17 -o server server.cpp -lboost_system -lpthread -lboost_beast
```

Эта команда компилирует `main.cpp` и устанавливает ссылки на библиотеки Boost (`boost_system`, `boost_beast`, `pthread`).

### 4. Запуск сервера

После компиляции вы можете запустить сервер следующим образом:

```bash
sudo ./server
```

Сервер будет прослушивать:

- **- **Telnet**: Порт `23`
- **HTTP/WebSocket**: порт `8001`

Логи будут сохранены в `server_log.txt`.

### 5. Тестирование сервера

#### Telnet

Чтобы протестировать функциональность Telnet, вы можете подключиться к серверу с помощью клиента Telnet:

```bash
telnet localhost 2323
```
##### Доступные команды Telnet:
- `get_ip`: Получение IP-адреса интерфейса.
- `set_ip <ip_address> <subnet_mask>`: Установка IP-адреса и маски подсети.

#### HTTP

Чтобы протестировать функциональность HTTP, вы можете использовать "curl" для отправки запросов GET и POST:

- **ПОЛУЧИТЬ IP-адрес**:

```bash
curl -X GET http://localhost:8001/ -H "Authorization: Bearer 1"
```

- **ОТПРАВИТЬ сообщение для установки IP-адреса**:

```bash
curl -X POST http://localhost:8001/ -H "Authorization: Bearer 1" -d '{"ip": "192.168.1.10", "mask": "24"}'
```

#### WebSocket

Для тестирования функциональности WebSocket вы можете использовать клиент WebSocket (например, "scat").:

```bash
wscat -c ws://localhost:8001/
```

После подключения вы будете получать обновления при каждом изменении IP-адреса или маски подсети.

### 6. Ведение журнала

Сервер регистрирует все действия в `server_log.txt`. Сюда входят:

- Информационные журналы
- Журналы ошибок
- Изменения IP-адреса

Чтобы просмотреть журналы, откройте файл:
```bash
cat server_log.txt
```

## Использование клиентской программы

Для компиляции программы используйте следующую команду:

```bash
g++ -o client client.cpp -lboost_system -lpthread
```

### Запуск программы

Запустите программу с необходимой командой. Доступные команды:

- `get_ip`: Получить текущий IP-адрес.
- `set_ip <IP> <MASK>`: Установить новый IP-адрес и маску.

**Примеры использования:**

1. Получение текущего IP-адреса:
    ```bash
    ./client get_ip
    ```

2. Установка нового IP-адреса и маски:
    ```bash
    ./client set_ip 192.168.1.100 255.255.255.0
    ```

 Поддерживаются изначально только маски 255.255.255.0, 255.255.0.0, 255.0.0.0. Если хотите использвовать другие маски нужно добавить их в функцию **mask_to_prefix**

### Обработка ошибок

Если вводятся некорректные команды или аргументы, программа выводит сообщение об ошибке:

- При неправильном количестве аргументов:
    ```
    Incorrect usage
    Usage: ./client <command> [args]
    Commands:
      get_ip
      set_ip <IP> <MASK>
    ```

- При неизвестной команде:
    ```
    Unknown command: <command>
    ```

- При ошибках соединения или других исключениях:
    ```
    [ERROR] Error: <описание ошибки>
    ```

## Примечания

- Убедитесь, что сервер, с которым программа взаимодействует, запущен и доступен по указанному UNIX-сокету (`/tmp/unix_socket`).
- Логи сохраняются в файл `client_log.txt`, который создается в каталоге, из которого запущена программа.

## Заключение

Данная программа является простым и эффективным клиентом для взаимодействия с сервером через UNIX-сокеты, позволяя выполнять базовые операции с IP-адресами. Программа также обеспечивает хорошую систему логирования для отслеживания действий и ошибок.